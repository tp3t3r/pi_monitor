<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="45">
    <title>RPi monitoring</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1>RPi monitoring</h1>
    <div id="info" style="margin: 10px 20px; font-size: 14px; color: #999;"></div>
    <div class="tabs">
        <button class="tab active" onclick="showTab('hour')">Last Hour</button>
        <button class="tab" onclick="showTab('all')">All Records</button>
    </div>
    <div style="margin: 10px 20px;">
        <a href="#cpu">CPU</a> | 
        <a href="#temp">Temperature</a> | 
        <a href="#memory">Memory</a> | 
        <a href="#disk">Disk</a> | 
        <a href="#network">Network</a> | 
        <a href="#diskio">Disk I/O</a>
    </div>
    <div id="all" class="content">
        <div id="cpu"><img src="/all/cpu" width="100%"></div>
        <div id="temp"><img src="/all/temp" width="100%"></div>
        <div id="memory"><img src="/all/memory" width="100%"></div>
        <div id="disk"><img src="/all/disk" width="100%"></div>
        <div id="network"><img src="/all/network" width="100%"></div>
        <div id="diskio"><img src="/all/diskio" width="100%"></div>
    </div>
    <div id="hour" class="content active">
        <div id="cpu"><img src="/hour/cpu" width="100%"></div>
        <div id="temp"><img src="/hour/temp" width="100%"></div>
        <div id="memory"><img src="/hour/memory" width="100%"></div>
        <div id="disk"><img src="/hour/disk" width="100%"></div>
        <div id="network"><img src="/hour/network" width="100%"></div>
        <div id="diskio"><img src="/hour/diskio" width="100%"></div>
    </div>
    <script>
    function showTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
        event.target.classList.add('active');
        document.getElementById(tab).classList.add('active');
    }
    
    function updateInfo() {
        const start = Date.now();
        fetch('/info')
            .then(r => r.json())
            .then(data => {
                const duration = Date.now() - start;
                document.getElementById('info').textContent = 
                    'System uptime: ' + data.uptime + ' | Page generation: ' + duration + 'ms';
            });
    }
    
    updateInfo();
    setInterval(updateInfo, 45000);
    </script>
</body>
</html>
